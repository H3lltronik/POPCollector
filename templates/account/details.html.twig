{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!{% endblock %}

{% block body %}
    {% if user is not null %}
        <div class="row" id="vue">
            <div class="col-12 col-lg-12">
                <div class="row align-items-baseline">
                    <span class="product_page_year mt-3 mr-2"><b>Detalles de la cuenta</b> </span>
                </div>
                <div class="row align-items-baseline">
                    <span class="product_page_description mt-2 mr-2"><b>Nombre:</b> </span> <span class="product_page_description">{{user.personalization.name}}</span>
                </div>
                <div class="row align-items-baseline">
                    {# <span class="product_page_description mt-2 mr-2"><b>Apellido paterno:</b> </span> <span class="product_page_description">{{user.personalization.fatherLastName}}</span> #}
                </div>
                <div class="row align-items-baseline">
                    {# <span class="product_page_description mt-2 mr-2"><b>Apellido materno:</b> </span> <span class="product_page_description">{{user.personalization.motherLastName}}</span> #}
                    {% if app.user.id|default(null) != user.id and isBuyer and subscribed != true %}
                        <div class="col-10 col-lg-3"><button id="suscribe" type="button" class="btn btn-primary mb-2">Suscribirse</button></div>
                    {% endif %}
                </div>
            </div>
            <div class="col-12 col-lg-12">
                <div class="row align-items-baseline my-lg-3">
                    <span class="product_page_year mt-3 mr-2"><b>Productos</b> </span>
                </div>
                <div class="row">
                    {% for product in pagination.items %}
                        {% if product.isVisible %}
                            <div class="col-12 col-lg-3">
                                {{render_product(product)}}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            {{ knp_pagination_render(pagination) }}
            </div>
        </div>
    {% else %}
        <div style="width: 80vw; height: 70vh;" class="d-flex justify-content-center align-items-center"><h3>Esta cuenta es privada :c</h3></div>
    {% endif %}
{% endblock %}

{% block javascripts %}
    <script>
        let vueProd = new Vue({
            el: "vue",
        })
        $("#suscribe").click(() => {
            $.post("{{path('subscribe_id', {account: user.id})}}").then(res => {
                $("#submit").prop("disabled", false);
                vueProd.$notify({
                    title: "Te has suscrito",
                    type: "success",
                    message: "Puedes ver sus sucripciones en tu perfil"
                })
                window.location.reload()
            }).catch(err => {
                vueProd.$notify({
                    title: "Error",
                    type: "error",
                    message: "Ocurrio un error"
                })
            })
        })
    </script>
{% endblock %}